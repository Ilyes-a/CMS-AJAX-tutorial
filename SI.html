<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Configuration du SystÃ¨me d'Information (SI)</title>
  <meta name="description" content="Guide complet pour configurer et structurer le SystÃ¨me d'Information pour l'intÃ©gration CMS.">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem auto;
      max-width: 960px;
      line-height: 1.6;
      color: #333;
    }
    h1, h2, h3 {
      color: #2c3e50;
    }
    code {
      background: #f4f4f4;
      padding: 2px 6px;
      border-radius: 5px;
    }
    pre {
      background: #f9f9f9;
      padding: 1rem;
      border-left: 4px solid #3498db;
      overflow-x: auto;
    }
    .diagram {
      display: flex;
      justify-content: center;
      margin: 2rem 0;
    }
  </style>
</head>
<body>
  <h1>ğŸ§© Configuration et Architecture du SystÃ¨me d'Information (SI)</h1>

  <p>Ce guide explique comment installer et structurer votre <strong>SystÃ¨me d'Information</strong> pour qu'il fonctionne avec <em>plusieurs CMS</em> comme WordPress ou WebsiteBaker.</p>

  <h2>ğŸ“ Architecture des fichiers</h2>
  <div class="diagram">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/64/Folder_icon.svg" alt="Structure des dossiers" width="80">
  </div>
  <pre><code>CMS-AJAX/
â”œâ”€â”€ API_SYS_INFORMATION/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ login.php
â”‚   â”‚   â”œâ”€â”€ register.php
â”‚   â”‚   â”œâ”€â”€ reserver.php
â”‚   â”‚   â”œâ”€â”€ mon-compte.php
â”‚   â”‚   â”œâ”€â”€ utils.php
â”‚   â”‚   â””â”€â”€ db.php
â”‚   â”œâ”€â”€ spa-php/
â”‚   â”‚   â”œâ”€â”€ login.html
â”‚   â”‚   â”œâ”€â”€ login.js
â”‚   â”‚   â”œâ”€â”€ register.html
â”‚   â”‚   â”œâ”€â”€ register.js
â”‚   â”‚   â”œâ”€â”€ mon-compte.js
â”‚   â”‚   â”œâ”€â”€ compte.html
â”‚   â”‚   â”œâ”€â”€ reservation.html
â”‚   â”‚   â”œâ”€â”€ reservation.js
â”‚   â”‚   â”œâ”€â”€ accueil.html
â”‚   â”‚   â”œâ”€â”€ accueil.js
â”‚   â”‚   â”œâ”€â”€ router.js
â”‚   â”‚   â””â”€â”€ style.css
â”‚   â””â”€â”€ redirect.php
â””â”€â”€ tennis_reservation.db
</code></pre>

  <h2>âš™ï¸ Fonctionnement gÃ©nÃ©ral</h2>
  <ul>
    <li>Les <strong>fichiers PHP</strong> situÃ©s dans <code>/api</code> traitent les appels AJAX (authentification, rÃ©servation, etc.).</li>
    <li>Les <strong>vues HTML</strong> sont dans <code>/spa-php</code> et sont injectÃ©es dans les CMS via fetch.</li>
    <li><code>router.js</code> gÃ¨re dynamiquement les chemins (WordPress: <code>/index.php</code>, WSB: <code>/pages</code>).</li>
    <li><code>redirect.php</code> est un proxy de redirection propre Ã  WSB pour simuler les routes classiques.</li>
  </ul>

  <h2>ğŸ§­ Gestion dynamique des routes</h2>
  <h3>ğŸ” redirect.php</h3>
  <p>Ce fichier agit comme un <strong>pont</strong> entre les CMS rigides (comme WebsiteBaker) et le SI.</p>
  <pre><code>&lt;?php
$uri = $_SERVER['REQUEST_URI'];
$parts = explode('/', $uri);
$route = end($parts);
header("Location: /pages/$route");
exit;
</code></pre>

  <h3>ğŸ“ router.js</h3>
  <p>Script global chargÃ© par toutes les pages JS du SI pour dÃ©tecter automatiquement le prÃ©fixe dâ€™URL :</p>
  <pre><code>const ROUTE_PREFIX = (() => {
  const current = window.location.pathname;
  if (current.includes("/pages/")) return "/pages";
  if (current.includes("/index.php/")) return "/index.php";
  return "";
})();</code></pre>

  <h2>ğŸ¨ Fichier CSS commun</h2>
  <p><code>style.css</code> est injectÃ© dynamiquement dans les CMS pour harmoniser lâ€™apparence avec le SI.</p>
  <pre><code>const cssHref = "http://192.168.1.77/style.css";
if (!document.querySelector(`link[href="${cssHref}"]`)) {
  const css = document.createElement("link");
  css.rel = "stylesheet";
  css.href = cssHref;
  document.head.appendChild(css);
}</code></pre>

  <h2>ğŸš€ Objectif final</h2>
  <p>Garder le CMS comme simple coquille (blog, menus) et dÃ©lÃ©guer toute la logique mÃ©tier (authentification, rÃ©servation) au SI.</p>
  <div class="diagram">
    <img src="https://upload.wikimedia.org/wikipedia/commons/4/45/Network_Diagram.svg" alt="Diagramme d'architecture" width="600">
  </div>

  <hr>
  <p><strong>ğŸ—“ï¸ DerniÃ¨re mise Ã  jour :</strong> Mars 2025</p>
  <p><em>Projet conÃ§u par Clovis Lahuiss â€“ IntÃ©gration CMS & SI modulaire</em></p>

</body>
</html>
