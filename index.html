<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cas G√©n√©ral - Int√©gration SI & CMS</title>
  <meta name="description" content="Tutoriel pour int√©grer dynamiquement un syst√®me d'information externe dans divers CMS (WebSiteBaker, WordPress, Joomla) via fetch()." />
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <header>
    <h1>üåê Cas G√©n√©ral - Int√©gration de notre SI avec nos CMS</h1>
  </header>

  <!-- Menu de navigation -->
  <nav>
    <ul>
      <li><a href="index.html">Accueil</a></li>
      <li><a href="wordpress.html">WordPress</a></li>
      <li><a href="joomla.html">Joomla</a></li>
      <li><a href="websitebaker.html">WebSiteBaker</a></li>
      <li><a href="SI.html">Syst√®me d'Information</a></li>
      <li><a href="CasGen.html">Cas G√©n√©ral</a></li>
    </ul>
  </nav>

  <main>
    <!-- Pr√©sentation du projet -->
    <section id="presentation-projet">
      <h2>Pr√©sentation du Projet</h2>
      <p>
        Ce projet a pour objectif de connecter de mani√®re fluide et dynamique un Syst√®me d‚ÄôInformation (SI) externe, d√©velopp√© en PHP, √† diff√©rents syst√®mes de gestion de contenu (CMS) tels que WordPress, Joomla ou WebSiteBaker.
      </p>
      <p>
        Le SI externe g√®re des fonctionnalit√©s essentielles pour un site web moderne, telles que :
      </p>
      <ul>
        <li><strong>L‚Äôauthentification</strong> : s√©curiser l‚Äôacc√®s aux pages r√©serv√©es aux utilisateurs.</li>
        <li><strong>La gestion des r√©servations</strong> : permettre aux utilisateurs de r√©server des services ou des ressources (comme des terrains de sport).</li>
        <li><strong>La gestion des profils utilisateurs</strong> : stocker et g√©rer les informations personnelles via une API REST s√©curis√©e.</li>
      </ul>
      <p>
        L‚Äôid√©e est de pouvoir int√©grer ce SI dans n‚Äôimporte quel CMS sans devoir modifier ses fichiers internes. Le contenu dynamique (HTML, CSS et JavaScript) est h√©berg√© sur le SI, tandis que le CMS continue de g√©rer ses propres articles, menus et autres contenus.
      </p>
      <p>
        <strong>Choisissez votre CMS</strong> : Pour acc√©der aux instructions d‚Äôint√©gration d√©taill√©es, s√©lectionnez le CMS souhait√© dans le menu ci-dessus.
      </p>
    </section>

    <!-- Partie 1 : Processus global -->
    <section id="integration-generale">
      <h2>1Ô∏è‚É£ Processus Global d'Int√©gration</h2>
      <p>
        Dans notre solution, chaque CMS (WebSiteBaker, WordPress, Joomla) est install√© sur sa propre machine virtuelle (VM) avec une adresse IP dans le r√©seau 192.168.1.X, tout comme notre Syst√®me d‚ÄôInformation (SI) externe.
      </p>
      <p>
        Le SI h√©berge l‚Äôensemble des pages statiques et scripts (HTML, CSS, JS) et fournit un fichier <code>router.js</code> qui adapte dynamiquement les routes √† utiliser selon le CMS appelant. Ce router se base, par exemple, sur la terminaison de l‚ÄôIP pour d√©finir :
      </p>
      <pre><code>
// router.js - D√©tection dynamique du CMS bas√© sur l'IP
const ROUTE_PREFIX = (() =&gt; {
  const host = window.location.hostname;
  if (host.endsWith("35")) return "/pages";      // WebsiteBaker
  if (host.endsWith("22")) return "/index.php";  // WordPress
  return ""; // fallback
})();

const ROUTE_SUFFIX = (() =&gt; {
  const host = window.location.hostname;
  if (host.endsWith("35")) return ".php";       // WebsiteBaker
  if (host.endsWith("22")) return "";           // WordPress
  return ""; // fallback
})();
      </code></pre>
      <p>
        Chaque CMS int√®gre dynamiquement le contenu du SI en utilisant la fonction <code>fetch()</code> pour r√©cup√©rer la vue correspondante. Par exemple, pour la page <strong>Login</strong>, un petit script HTML+JS est ins√©r√© dans la page du CMS :
      </p>
      <h3>üîê Exemple - Page Login</h3>
      <pre><code>&lt;div id="app-login"&gt;&lt;/div&gt;
&lt;script&gt;
document.addEventListener("DOMContentLoaded", () =&gt; {
  const token = localStorage.getItem("jwt");
  if (token) {
    window.location.href = "/pages/mon-compte";
    return;
  }

  const cssHref = "http://192.168.1.77/style.css";
  if (!document.querySelector(`link[href="${cssHref}"]`)) {
    const css = document.createElement("link");
    css.rel = "stylesheet";
    css.href = cssHref;
    document.head.appendChild(css);
  }

  fetch("http://192.168.1.77/login.html")
    .then(res =&gt; res.text())
    .then(html =&gt; {
      document.getElementById("app-login").innerHTML = html;
      const script = document.createElement("script");
      script.src = "http://192.168.1.77/login.js";
      document.body.appendChild(script);
    });
});
&lt;/script&gt;
      </code></pre>
      <p>
        Le m√™me principe est appliqu√© pour les pages <strong>Register</strong>, <strong>Mon Compte</strong>, <strong>R√©server</strong> et <strong>Accueil</strong>, en rempla√ßant simplement les chemins des fichiers HTML et JS.
      </p>
    </section>

    <!-- Partie 2 : Cas d'utilisation sur un m√™me serveur -->
    <section id="integration-meme-serveur">
      <h2>2Ô∏è‚É£ Cas d'Utilisation sur un M√™me Serveur</h2>
      <p>
        Dans la configuration initiale, chaque CMS et le SI externe √©taient install√©s sur des machines virtuelles distinctes, chacune ayant sa propre adresse IP dans le r√©seau 192.168.1.X.
      </p>
      <p>
        <strong>Mais que se passe-t-il si tous les syst√®mes sont h√©berg√©s sur le m√™me serveur ?</strong>
      </p>
      <p>
        Lorsque les CMS et le SI partagent la m√™me adresse IP, la m√©thode de d√©tection du CMS bas√©e sur la terminaison de l'IP ne fonctionne plus. En effet, tous renverront la m√™me IP, rendant la d√©tection ambigu√´.
      </p>
      <p>
        Cela signifie que le router ne pourra pas d√©finir correctement les variables <code>ROUTE_PREFIX</code> et <code>ROUTE_SUFFIX</code>, et que les liens g√©n√©r√©s risquent de ne pas correspondre aux routes attendues par chaque CMS.
      </p>
      <p>
        Pour pallier ce probl√®me, plusieurs solutions sont envisageables :
      </p>
      <ul>
        <li>
          <em>Utiliser des sous-domaines distincts :</em> Par exemple, assigner <code>wordpress.example.com</code>, <code>joomla.example.com</code> et <code>si.example.com</code> permet de diff√©rencier les appels en d√©tectant le sous-domaine dans le router.
        </li>
        <li>
          <em>Utiliser une configuration explicite :</em> Plut√¥t que de se baser sur l'IP, passer manuellement les valeurs de <code>ROUTE_PREFIX</code> et <code>ROUTE_SUFFIX</code> via un fichier de configuration ou des variables d'environnement.
        </li>
      </ul>
      <p>
        Voici un exemple de modification du router pour une d√©tection bas√©e sur le sous-domaine :
      </p>
      <pre><code>
// router.js - D√©tection du CMS bas√©e sur le sous-domaine
const hostname = window.location.hostname;
const ROUTE_PREFIX = (() =&gt; {
  if (hostname.startsWith("websitebaker.")) return "/pages"; // WebsiteBaker
  if (hostname.startsWith("wordpress.")) return "/index.php"; // WordPress
  return ""; // fallback
})();
const ROUTE_SUFFIX = (() =&gt; {
  if (hostname.startsWith("websitebaker.")) return ".php"; // WebsiteBaker
  if (hostname.startsWith("wordpress.")) return "";     // WordPress
  return ""; // fallback
})();
      </code></pre>
      <p>
        En adoptant l'une de ces solutions, m√™me en cas d'h√©bergement sur un m√™me serveur, le SI pourra correctement d√©terminer les routes et s'int√©grer de mani√®re transparente avec chaque CMS.
      </p>
    </section>

    <!-- R√©sultat global -->
    <section id="resultat">
      <h2>üéØ R√©sultat Global</h2>
      <p>
        Gr√¢ce √† ce syst√®me d'int√©gration, les CMS continuent de g√©rer leurs propres menus et articles tandis que le contenu dynamique (pages de login, inscription, profil, r√©servation, etc.) est import√© depuis un SI externe.
        Cela garantit une exp√©rience utilisateur homog√®ne et un design coh√©rent, puisque tous les sites utilisent un m√™me fichier <code>style.css</code> pour la pr√©sentation.
      </p>
      <p>
        En r√©sum√©, le projet permet d'all√©ger la charge de modification des CMS en externalisant certaines fonctionnalit√©s critiques tout en conservant la flexibilit√© et l‚Äôind√©pendance du Syst√®me d‚ÄôInformation.
      </p>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Grp ISEN M1. Tous droits r√©serv√©s.</p>
  </footer>

</body>
</html>
